<!doctype html>
<html>
  <head>
	<meta name="viewport" content="width=device-width, initial-scale=1" />
<!-- iOsで動画再生に必須　-->
	<meta name="apple-mobile-web-app-capable" content="yes">

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://cdn.jsdelivr.net/gh/hiukim/mind-ar-js@1.1.5/dist/mindar-image.prod.js"></script>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/hiukim/mind-ar-js@1.1.5/dist/mindar-image-aframe.prod.js"></script>
	<script src="./assets/main.js"></script>
	  
	  <script>
AFRAME.registerComponent('movie', {
  init: function () {
    const el = this.el

    let isPlayed = false
    const movie = document.getElementById("movie")

    // a-videoがクリックされたら動画を再生
    this.el.addEventListener("click", () => {
      if(!isPlayed) {
        el.attributes["material"].value = "src: #movie"
        isPlayed = true
      }

      if(movie.paused) {
        movie.play()
      }else {
        movie.pause()
      }
    })

    // 動画の読み込みが完了したら動画を再生
    // ただしiPhoneでは自動再生ができないのでクリックする必要がある
    movie.addEventListener("loadeddata", () => {
      aVideo.attributes["material"].value = "src: #movie"
      isPlayed = true
      movie.play()
    })
  }
})
</script>
	  
</head>
  
	<body>    
<a-scene mindar-image="imageTargetSrc: ./assets/targets2.mind;" color-space="sRGB" renderer="colorManagement: true, physicallyCorrectLights" vr-mode-ui="enabled: false" device-orientation-permission-ui="enabled: false">
      
	<a-assets>
        <a-asset-item id="bearModel" src="https://cdn.jsdelivr.net/gh/hiukim/mind-ar-js@1.1.5/examples/image-tracking/assets/band-example/bear/scene.gltf"></a-asset-item>
        <a-asset-item id="raccoonModel" src="https://cdn.jsdelivr.net/gh/hiukim/mind-ar-js@1.1.5/examples/image-tracking/assets/band-example/raccoon/scene.gltf"></a-asset-item>
		
		<video id="movie" src="./assets/video2.mp4" webkit-playsinline playsinline loop="true"></video>
		<img id="img_play" src="./assets/img_play.png">
		<img id="img_pause" src="./assets/img_pause.png">
		<img id="preview" src="./assets/preview.png">
		<img id="youtube" src="./assets/youtube.png">	
	</a-assets>

	<a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

<!-- target0 -->
<a-entity id="mytarget" mytarget mindar-image-target="targetIndex: 0">
	
<a-image id="my_btn01" class="clickable" click-play src="#img_pause" position="0 -0.5 0" scale="0.2 0.2 0.2"></a-image>
<a-video material="scr:./assets/preview.png" src="#movie" movie position="0 0 0" rotation="0 0 0" width="1" height="0.6"></a-video>
	
</a-entity>
	
<!-- target1 -->  
<a-entity id="mytarget1" mytarget1 mindar-image-target="targetIndex: 1">
	
<a-image visible="false" class="clickable" src="#youtube" position="0.42 -0.5 0" height="0.15" width="0.15"
link="href: https://www.youtube.com/channel/UC262c4cdRkfrllw37mpUKOA/videos; title: Senior Travel;"
></a-image>
			
</a-entity>

</a-scene>
  </body>
</html>